clear
clc
a = .02;
E = 200000000000;
L = 3;
D = a*E*[1/L 0 0 0 0 0 0 0 0 0; 0 1/L 0 0 0 0 0 0 0 0; 0 0 1/L 0 0 0 0 0 0 0; 0 0 0 1/(sqrt(2)*L) 0 0 0 0 0 0; 0 0 0 0 1/L 0 0 0 0 0; 0 0 0 0 0 1/(sqrt(2)*L) 0 0 0 0; 0 0 0 0 0 0 1/L 0 0 0; 0 0 0 0 0 0 0 1/(sqrt(2)*L) 0 0; 0 0 0 0 0 0 0 0 1/L 0; 0 0 0 0 0 0 0 0 0 1/(sqrt(2)*L)];
B_T = [-1 0 0 -1/sqrt(2) 0 0 0 0 0 0; 0 0 0 1/sqrt(2) 0 0 0 0 0 0; 1 -1 0 0 0 -1/sqrt(2) 0 0 0 0; 0 0 0 0 1 1/sqrt(2) 0 0 0 0; 0 1 -1 0 0 0 0 0 0 1/sqrt(2); 0 0 0 0 0 0 1 0 0 1/sqrt(2); 0 0 1 0 0 0 0 1/sqrt(2) 0 0; 0 0 0 0 0 0 0 1/sqrt(2) 0 0; 0 0 0 0 0 1/sqrt(2) 0 -1/sqrt(2) 1 0; 0 0 0 0 0 -1/sqrt(2) -1 -1/sqrt(2) 0 0; 0 0 0 1/sqrt(2) 0 0 0 0 -1 -1/sqrt(2); 0 0 0 -1/sqrt(2) -1 0 0 0 0 -1/sqrt(2)];
B = B_T';
K = B_T*D*B;
K_c_1 = K(:,1);
K_c_2 = K(:,2);
K_c_3 = K(:,3);
K_c_4 = K(:,4);
K_c_5 = K(:,5);
K_c_6 = K(:,6);
K_c_7 = K(:,7);
K_c_8 = K(:,8);
K_c_9 = K(:,9);
K_c_10 = K(:,10);
K_c_11 = K(:,11);
K_c_12 = K(:,12);
K_bar = [K_c_1 K_c_2 K_c_7 K_c_8 K_c_3 K_c_4 K_c_5 K_c_6 K_c_9 K_c_10 K_c_11 K_c_12]; 
K_r_1 = K_bar(1,:);
K_r_2 = K_bar(2,:);
K_r_3 = K_bar(3,:);
K_r_4 = K_bar(4,:);
K_r_5 = K_bar(5,:);
K_r_6 = K_bar(6,:);
K_r_7 = K_bar(7,:);
K_r_8 = K_bar(8,:);
K_r_9 = K_bar(9,:);
K_r_10 = K_bar(10,:);
K_r_11 = K_bar(11,:);
K_r_12 = K_bar(12,:);
K_bar_bar = [K_r_1;K_r_2;K_r_7;K_r_8;K_r_3;K_r_4;K_r_5;K_r_6;K_r_9;K_r_10;K_r_11;K_r_12];
K_bar_bar(10,10) = K_bar_bar(10,10)+600000000;
K_bar_bar_bar = K_bar_bar(5:12,5:12);
F_k = [0 0 0 -150000 0 0 100000 0]';
U_u = (K_bar_bar_bar\F_k);
F_u = K_bar_bar(1:4,5:12)*U_u;
U_k = [0;0;0;0];
U_all = [U_k(1:2,1);U_u(1:4,1);U_k(3:4,1);U_u(5:8,1)];
Q = D*B*U_all;
